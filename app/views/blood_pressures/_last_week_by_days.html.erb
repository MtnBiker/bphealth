<!-- Variable for use below -->
<% last_record = BloodPressure.last.statdate  # last_record: 2021-12-26 04:40:23 UTC, but in db as 2021-12-25 20:40:23-08 %>
<% timeZone = last_record.localtime.formatted_offset(false).slice!(0, 3).to_i %> 
<% timeZoneNeg = -last_record.localtime.formatted_offset(false).slice!(0, 3).to_i %> <!-- Just because I'm substracting it and it may be easier to use a positive number or not. Don't need to, but had problems at beginning so left it, but could change sign and variable<br> -->
<% last_record_minus_zone = last_record - timeZone %>

<!-- xmin: "2021-01-01", xmax: "2022-01-01" How do you tell Rails 3am to 12 pm or similar-->

<!-- Stack 7 daily records, then maybe put on one graph when I figure it out -->
<!-- :stattime is a symbol, so can't use .localtime to get the time showing right -->
<!-- The order of the variables and methods in the following matters -->
<div class="text-center font-weight-bold">
  <%= line_chart BpTimeWithZone.where(statdate: last_record+timeZoneNeg.hour-1.day..last_record).pluck(:stattime, :systolic), title: "Last week by days (Most recent at top). Up to #{last_record.strftime("%c")}. The x-axis is GMT", ytitle: "Systolic", min: 100, max: 200, color: "#D9A1FF" %>
  <%= line_chart BpTimeWithZone.where(statdate: last_record+timeZoneNeg.hour-2.day..last_record+timeZoneNeg-1.day).pluck(:stattime, :systolic), ytitle: "Systolic", min: 100, max: 200, color: "#D9A1FF" %>
  <%= line_chart BpTimeWithZone.where(statdate: last_record+timeZoneNeg.hour-3.day..last_record+timeZoneNeg-2.day).pluck(:stattime, :systolic), ytitle: "Systolic", min: 100, max: 200, color: "#D9A1FF" %>
  <%= line_chart BpTimeWithZone.where(statdate: last_record+timeZoneNeg.hour-4.day..last_record+timeZoneNeg-3.day).pluck(:stattime, :systolic), ytitle: "Systolic", min: 100, max: 200, color: "#D9A1FF" %>
  <%= line_chart BpTimeWithZone.where(statdate: last_record+timeZoneNeg.hour-5.day..last_record+timeZoneNeg-4.day).pluck(:stattime, :systolic), ytitle: "Systolic", min: 100, max: 200, color: "#D9A1FF" %>
  <%= line_chart BpTimeWithZone.where(statdate: last_record+timeZoneNeg.hour-6.day..last_record+timeZoneNeg-5.day).pluck(:stattime, :systolic), ytitle: "Systolic", min: 100, max: 200, color: "#D9A1FF" %>
  <%= line_chart BpTimeWithZone.where(statdate: last_record+timeZoneNeg.hour-7.day..last_record+timeZoneNeg-6.day).pluck(:stattime, :systolic), ytitle: "Systolic", min: 100, max: 200, color: "#D9A1FF" %>
</div>
